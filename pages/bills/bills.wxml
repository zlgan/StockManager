<!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
<view class="container">
  <!-- æœç´¢ç­›é€‰åŒºåŸŸ -->
  <view class="card">
    <!-- æœç´¢æ¡† -->
    <view class="form-group">
      <view class="form-label">æœç´¢</view>
      <view class="form-row">
        <input class="form-control flex-grow" placeholder="æœç´¢äº§å“åç§°/å•æ®å·/åˆ¶å•äºº" value="{{searchKeyword}}" bindinput="inputSearchKeyword" />
        <view class="btn-icon" bindtap="scanCode">
          <image class="scan-image" src="/images/scan.png" mode="aspectFit"></image>
        </view>
      </view>
    </view>
    
    <!-- æ—¥æœŸèŒƒå›´ -->
    <view class="form-group">
      <view class="form-label">æ—¥æœŸèŒƒå›´</view>
      <view class="date-range-container">
        <picker mode="date" value="{{startDate}}" bindchange="bindStartDateChange" class="flex-grow">
          <view class="picker">{{startDate || 'å¼€å§‹æ—¥æœŸ'}}</view>
        </picker>
        <view class="date-separator">è‡³</view>
        <picker mode="date" value="{{endDate}}" bindchange="bindEndDateChange" class="flex-grow">
          <view class="picker">{{endDate || 'ç»“æŸæ—¥æœŸ'}}</view>
        </picker>
      </view>
    </view>
    
    <!-- å•æ®ç±»å‹ -->
    <view class="form-group">
      <view class="form-label">å•æ®ç±»å‹</view>
      <picker bindchange="bindBillTypeChange" value="{{billTypeIndex}}" range="{{billTypes}}" class="flex-grow">
        <view class="form-control picker">
          {{billTypes[billTypeIndex]}}
        </view>
      </picker>
    </view>
    
    <!-- ä¾›åº”å•†/å®¢æˆ· -->
    <view class="form-group">
      <view class="form-label">ä¾›åº”å•†</view>
      <picker bindchange="bindSupplierChange" value="{{supplierIndex}}" range="{{suppliers}}" class="flex-grow">
        <view class="form-control picker">
          {{suppliers[supplierIndex]}}
        </view>
      </picker>
    </view>

    <!-- å®¢æˆ· -->
    <view class="form-group">
      <view class="form-label">å®¢æˆ·</view>
      <picker bindchange="bindCustomerChange" value="{{customerIndex}}" range="{{customers}}" class="flex-grow">
        <view class="form-control picker">
          {{customers[customerIndex]}}
        </view>
      </picker>
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="btn-group">
      <button class="btn btn-primary" bindtap="search">æœç´¢</button>
      <button class="btn btn-outline" bindtap="reset">é‡ç½®</button>
    </view>
  </view>
  
  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="card">
    <view class="stats-header">
      <view class="stats-count">å…± {{totalCount}} ç¬”è®°å½•</view>
      <view class="export-btn" bindtap="exportToExcel">
        <text class="icon-download"></text> å¯¼å‡ºExcel
      </view>
    </view>
  </view>
  
  <!-- å•æ®åˆ—è¡¨ -->
  <block wx:for="{{bills}}" wx:key="id">
    <view class="card bill-card" bindtap="viewBillDetail" data-id="{{item.id}}">
      <!-- å•æ®å¤´éƒ¨ä¿¡æ¯ -->
      <view class="bill-header">
        <view class="bill-number {{item.type}}">
          <text class="bill-type-label">{{item.type === 'inbound' ? 'å…¥åº“å•' : 'å‡ºåº“å•'}}</text>
          <text class="bill-number-text">{{item.billNumber}}</text>
        </view>
        <view class="bill-date">{{item.date}}</view>
      </view>
      
      <!-- äº§å“ä¿¡æ¯ -->
      <view class="bill-products">
        <block wx:for="{{item.products}}" wx:for-item="product" wx:key="index">
          <view class="product-item">
            <view class="product-info">
              <view class="product-name">{{product.name}}</view>
              <view class="product-model" wx:if="{{product.model}}">å‹å·: {{product.model}}</view>
            </view>
            <view class="product-quantity {{item.type}}">
              {{item.type === 'inbound' ? '+' : '-'}}{{product.quantity}}
            </view>
          </view>
        </block>
      </view>
      
      <!-- å•æ®åº•éƒ¨ä¿¡æ¯ -->
      <view class="bill-footer">
        <view class="bill-info">
          <view class="bill-type-name">{{item.billTypeName}}</view>
          <view class="bill-supplier" wx:if="{{item.supplier}}">{{item.supplier}}</view>
        </view>
        <view class="bill-amount">Â¥{{item.totalAmount}}</view>
      </view>
      
      <view class="bill-creator">åˆ¶å•äºº: {{item.creator}}</view>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <view class="bill-actions">
        <view class="action-btn" bindtap="editBill" data-id="{{item.id}}" catchtap="stopPropagation">
          <text class="icon-edit"></text> ç¼–è¾‘
        </view>
        <view class="action-btn delete" bindtap="deleteBill" data-id="{{item.id}}" catchtap="stopPropagation">
          <text class="icon-delete"></text> åˆ é™¤
        </view>
      </view>
    </view>
  </block>
  
  <!-- æ— æ•°æ®æç¤º -->
  <view class="empty-state" wx:if="{{bills.length === 0}}">
    <view class="empty-icon">ğŸ“‹</view>
    <view class="empty-text">æš‚æ— å•æ®æ•°æ®</view>
    <view class="empty-hint">æ‚¨å¯ä»¥é€šè¿‡æœç´¢æˆ–è°ƒæ•´ç­›é€‰æ¡ä»¶æŸ¥çœ‹ç›¸å…³å•æ®</view>
  </view>
  
  <!-- å¯¼å‡ºæˆåŠŸæç¤º -->
  <view class="modal-overlay" wx:if="{{showExportSuccess}}" bindtap="hideExportSuccess">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="success-icon">âœ…</view>
      <view class="modal-title">å¯¼å‡ºæˆåŠŸ</view>
      <view class="modal-message">æ–‡ä»¶å·²ä¿å­˜è‡³"æˆ‘çš„æ–‡æ¡£"</view>
      <button class="btn btn-primary" bindtap="hideExportSuccess">ç¡®å®š</button>
    </view>
  </view>
</view>